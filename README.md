# SKN06-FINAL-6Team
### 육캔두잇

### 🧑‍🤝‍🧑 팀원

| 김동훈 | 조해원 | 강채연 | 전수연 | 임연경 |
|-------|------|------|------|------|
| <img src="https://github.com/SKNETWORKS-FAMILY-AICAMP/SKN06-FINAL-6Team/blob/main/%EC%B5%9C%EC%A2%85%ED%8F%89%EA%B0%80%20%EC%82%B0%EC%B6%9C%EB%AC%BC/readme%20%EC%82%AC%EC%A7%84/%EA%B9%80%EB%8F%99%ED%9B%88.jpg" alt="image" width="250" height="250"/> | <img src="https://github.com/SKNETWORKS-FAMILY-AICAMP/SKN06-FINAL-6Team/blob/main/%EC%B5%9C%EC%A2%85%ED%8F%89%EA%B0%80%20%EC%82%B0%EC%B6%9C%EB%AC%BC/readme%20%EC%82%AC%EC%A7%84/%EC%A1%B0%ED%95%B4%EC%9B%90.jpg" alt="image" width="250" height="250"/> | <img src="https://github.com/SKNETWORKS-FAMILY-AICAMP/SKN06-FINAL-6Team/blob/main/%EC%B5%9C%EC%A2%85%ED%8F%89%EA%B0%80%20%EC%82%B0%EC%B6%9C%EB%AC%BC/readme%20%EC%82%AC%EC%A7%84/%EA%B0%95%EC%B1%84%EC%97%B0.jpg" alt="image" width="250" height="250"/> | <img src="https://github.com/SKNETWORKS-FAMILY-AICAMP/SKN06-FINAL-6Team/blob/main/%EC%B5%9C%EC%A2%85%ED%8F%89%EA%B0%80%20%EC%82%B0%EC%B6%9C%EB%AC%BC/readme%20%EC%82%AC%EC%A7%84/%EC%A0%84%EC%88%98%EC%97%B0.jpg" alt="image" width="250" height="250"/> |  <img src="https://github.com/SKNETWORKS-FAMILY-AICAMP/SKN06-FINAL-6Team/blob/main/%EC%B5%9C%EC%A2%85%ED%8F%89%EA%B0%80%20%EC%82%B0%EC%B6%9C%EB%AC%BC/readme%20%EC%82%AC%EC%A7%84/%EC%9E%84%EC%97%B0%EA%B2%BD.png" alt="image" width="250" height="250"/> |
| 백엔드 | 프론트엔드  | 팀장  | 백엔드 | 프론트엔드 |

</br>

# 👩🏻‍🍳 레시피 추천 챗봇 🧑🏻‍🍳 (06. LLM활용 고객 상담 챗봇)

### ✔️ 개발 기간 및 주차별 진행과정

2025.01.21 ~ 2025.03.20(38일간)
> **1주차 ~ 2주차**
>
> - 주제 선정 및 자료 조사
>
> - 데이터 수집
>
> **3주차 ~ 4주차**
>
> - 데이터 수집 및 전처리
>
> - db 설계
>
> - 와이어프레임 제작
>
> **5주차**
>
> - lllm 개발
>
> - object detection 학습
>
> - api설계
>
> **6주차 ~ 7주차**
>
> - llm 최적화
>
> - object detection 최적화
>
> - 화면 설계 및 프론트 설계
>
> - 프론트 디자인
>
> **8주차**
>
> - llm 최적화
>
> - 프론트 마무리
>
> - 최종 마무리 및 발표 자료 제작
>   

### ✔️ 개요
1. 자취생과 1인 가구 증가 : 혼자 생활하면서 겪는 어려움(요리, 식비 절약 등)에 대한 해결책이 필요하다
2. 요린이 : ‘요리+어린이=요린이’라는 신조어, 이들이 간단하고 쉽게 요리할 수 있는 솔루션이 필요하다
3. 배달 이용 증가 : 비용 부담과 건강 문제 때문에 단순히 배달에 의존하기보다, 이를 효율적으로 활용하거나 대체할 수 있는 방안이 필요하다

### ✔️ 목표

1인 가구와 자취생, 주부들을 위한 맞춤형 레시피 추천 챗봇을 개발하여 쉽고 건강한 식생활을 지원한다.

### ✔️ 프로젝트 내용
맞춤형 레시피 추천, 대화형 요리 가이드, 대체 재료 추천 및 트렌드 반영

</br>

#### ✔️ Stacks

![Discord](https://img.shields.io/badge/discord-5865F2?style=for-the-badge&logo=discord&logoColor=white)

![Python](https://img.shields.io/badge/python-3776AB?style=for-the-badge&logo=python&logoColor=white)
![pandas](https://img.shields.io/badge/pandas-150458?style=for-the-badge&logo=pandas&logoColor=white)
<img src="https://img.shields.io/badge/scikitlearn-%23F7931E?style=for-the-badge&logo=scikitlearn&logoColor=white"/>

</br>

![Git](https://img.shields.io/badge/Git-F05032?style=for-the-badge&logo=Git&logoColor=white)
![Github](https://img.shields.io/badge/GitHub-181717?style=for-the-badge&logo=GitHub&logoColor=white)

#### ✔️ Requirements


## 챗봇 이름 및 로고

  꾸깃꾸깃(Cook it, Cook Eat!)
  > 요리를 하고 맛있게 먹자!
  >
  > 냉장고 속 재료를 꾸깃꾸깃 활용!
  >
  > 요리 고민도 꾸깃꾸깃 접어두세요!
  >

## 경쟁 서비스
  ### 냉장고 파먹기
  주요기능
  > 즐겨찾기 기능 : 사용자가 원하는 레시피를 저장.
  >
  > 여러 식재료를 입력하면 레시피에 필요한 보유 재료와 부족한 재료를 구분하여 표시.
  >
  > 선택한 레시피를 클릭하면 ‘만개레시피’ 사이트로 이동하여 레시피 제공 (같은 메뉴의 다양한 레시피 확인)
  >
  > 검색 기능 : 특정 재료 또는 요리법 검색 가능.
  >

  단점 및 한계
  >만개레시피 사이트에서 가져오는 방식이므로 관련 없는 레시피가 함께 추천
  >
  
  ### 거꾸로 레시피
  주요기능
  > 북마크 기능: 사용자가 원하는 레시피를 저장.
  >
  > 한 가지 이상의 식재료를 입력하면 해당 재료 중 하나라도 포함된 레시피를 추천.
  >
  > 소비기한 알림: 음식물 쓰레기를 줄이는데 도움.
  >
  
  단점 및 한계
  > 아이폰에서만 사용 가능.
  >
  > 등록된 레시피 종류가 적음.
  >
  > 단순한 재료 매칭 기반으로 이루어져 사용자 맞춤형 추천 기능이 부족.
  >
  
  ### 냉장고 즉석 레시피
  주요기능
  > 사용자가 가진 재료를 입력하면 간단한 요리법부터 비건요리까지 추천.
  >
  > 업로드한 사진에서 재료를 인식해 요리 추천.
  >
  > 요리 과정 중 유용한 팁이나 셰프의 꿀팁 제공.
  >
  > ChatGPT 사이트를 통해 서비스를 하고 있어 GPT 기본 기능 사용 가능. (TTS, 예상 완성 이미지 생성해 제공)
  > 
  
  단점 및 한계
  > 리뷰 기능이 없어 사용자가 처음 보는 요리라면 맛에 대한 확신이 부족.
  >
  > 실제 요리 완성 사진이 아닌 생성된 요리 완성 이미지 제공.
  >

## 차별점
  기술적 차별화
  > AI 챗봇을 활용하여 실시간으로 사용자가 입력한 재료 분석 후, 레시피 추천
  >
  > “냉장고 속 재료” 기반의 개인 맞춤형 레시피 제공
  >
  
  사용자 경험 개선
  > 음성 입력 또는 사진 분석(재료 인식)으로 인터페이스 단순화
  >
  
  웹기반 플렛폼
  > 기존의 앱 기반 서비스와 달리 운영체제(OS) 제한 없이 접근 가능
  >
  
  사용자 참여형
  > 사용자들이 선택한 레시피에 대해 리뷰를 작성, 열람가능
  >

## 활용 방안 및 기대 효과
1. 사용자의 요리 고민 해결
> AI가 사용자 맞춤형 레시피를 추천하여 "오늘 뭐 먹지?"에 대한 고민을 덜어줍니다.
> 
2. 음식 낭비 방지 (남은 재료 활용 추천)
>냉장고 속 남은 재료를 활용한 맞춤형 요리를 추천하여 식재료 낭비를 줄입니다.
>
3. 요리 초보자도 쉽게 따라할 수 있는 요리 가이드
> AI 챗봇이 단계별 대화형 요리 가이드를 제공하여 누구나 쉽게 요리할 수 있도록 돕습니다.
> 
4. 맞춤형 서비스 제공으로 사용자 만족도 증가
> 개인 취향과 재료를 반영한 맞춤형 추천을 통해 사용자 경험을 향상시킵니다.
> 

## data 수집 및 전처리
### 수집데이터
1. 만개레시피
2. JTBC(냉장고를 부탁해)
3. 편스토랑

### 전처리
1. 만개레시피
> ingredients(재료) : 불용어 처리(구매)
> 
> name(요리명) : 띄어쓰기, 맞춤법, 요리명으로 이름 변경(돼지고기 김치찌개와 같이 특정 재료가 포함된 경우는 유지)
>
> ex) 맛있는 돼지 김치찌개 -> 돼지 김치찌개
> 
> intro(음식소개), recipe(조리순서) : 띄어쓰기, 맞춤법, 어체 수정("~합니다." 또는 "~하세요")
>

2. JTBC(냉장고를 부탁해)
> name(요리명) : 불용어 처리(~의), 요리사 이름 일치     ex) '샘 킴'-> '샘킴'
>
> ingredients(재료) :불용어 처리(재료, 특수문자), 공백 추가하여 가독성 향상
>
> recipe(조리순서) : 불용어 처리(조리방법), 공백을 추가해 가독성 향상
>
> img, video : 결측치 처리('no img', 'no video')
>

3. 편스토랑
> name(요리명) : 불용어 처리(해당 회차 번호, HTML 엔터키) , '이름 - 요리' 레시피 형태로 정제, 중복 데이터 삭제
> 
> ingredients(재료) : 불용어 처리(개행문자, 공백, 특수문자), 각 재료별 문장 형태 일치
> 
> recipe(조리순서) : 불용어 처리(특수문자, 불필요한 공백, 불필요한 문장 - 해당 레시피는 편스토랑 인스타그램에도 확인할 수 있습니다.)
>

## 와이어프레임
![image](https://github.com/SKNETWORKS-FAMILY-AICAMP/SKN06-FINAL-6Team/blob/main/%EC%B5%9C%EC%A2%85%ED%8F%89%EA%B0%80%20%EC%82%B0%EC%B6%9C%EB%AC%BC/readme%20%EC%82%AC%EC%A7%84/%EC%99%80%EC%9D%B4%EC%96%B4%ED%94%84%EB%A0%88%EC%9E%84.png)

**account(app)**
 - 회원가입, 로그인, 아이디찾기, 비밀번호 찾기, mypage
 </br>
**chat(app)**
 - 채팅화면
 </br>
**cook(project)**
 - 홈화면
 </br>
**review(app)**
 - 리뷰게시판, 리뷰작성, 리뷰 자세히보기, 리뷰 수정하기
</br>
## DB설계 
![image](https://github.com/SKNETWORKS-FAMILY-AICAMP/SKN06-FINAL-6Team/blob/main/%EC%B5%9C%EC%A2%85%ED%8F%89%EA%B0%80%20%EC%82%B0%EC%B6%9C%EB%AC%BC/readme%20%EC%82%AC%EC%A7%84/DB.png)
 - Users ↔ Chats, Reviews,  HistoryChat, UserSelectedMenus(1:N)
 </br>
 - ChatSession ↔ UserSelectedMenus (1:N) 
 </br>
 - UserSelectedMenus ↔ ManRecipes,FridgeRecipes, FunsRecipes, UserReviews (N:1)
 </br>
 - UserReviews ↔ ReviewComments, ReviewImages (1:N)
 </br>
 - AdminLogs ↔ UserReviews, ReviewComments (N:1)
</br>

## ObjectDetection
### 데이터셋
1. 식재료 이미지 데이터셋(9831개)
   > model_size = n
   >
   > epoch = 100
   >
   > mAP 성능(train | val | test : 0.803 | 0.90 | 0.901)
   > 
2. 냉장고 내부 이미지 데이터셋(8445개)
   > model_size = n
   > 
   > epoch = 50
   > 
   > mAP 성능(train | val | test : 0.962 | 0.95 | 0.942)
   > 
</br>

### 학습된 모델 2개 로드(yolo_model_food, yolo_model_fridge)
문제 : YOLO로 사전 학습되지 않은 클래스에 대한 탐지 수행하기 위해 CLIP 결합
</br>
### 학습된 모델 2개 + CLIP
**CLIP을 활용한 YOLO 탐지 보완 시스템(전체적인 방향)**
</br>
기존 YOLO 탐지 클래스: 150개</br>
추가된 클래스 (한국인 냉장고 식재료 140개)</br>
   => 카테고리: 채소, 버섯류, 과일, 육류, 해산물, 유제품, 곡류 및 견과류, 양념 & 가공식품, 기타 (두부, 떡, 어묵, 파스타 등)
</br>
</br>
**YOLO + CLIP 보완 탐지 프로세스(세부내역)**
</br>
 - YOLO 탐지 신뢰도 0.4 미만 </br>
         → CLIP으로 보완 탐지 수행</br>
         </br>
 - YOLO가 객체를 찾지 못할 경우 </br>
         → 이미지 전체에 대해 CLIP 탐지 수행</br>
         </br>
 - YOLO의 한계를 보완하여 탐지 성능 향상
</br>
  문제 : 객제 감지 실패를 해결하기 위해 CLIP 유사도 임계값 추가
</br>
### YOLO + CLIP 결합 (CLIP 유사도 임계값 추가)
- 학습된 YOLO를 통해 객체 탐지 수행</br>
- YOLO로 탐지된 객체가 없거나, 탐지된 객체의 신뢰도가 0.4 미만인 경우 CLIP 보완 탐지 수행</br>
- CLIP 보완 탐지 결과 유사도 값이 0.5 이상인 것만 출력
=> 최종 모델 평가
![image](https://github.com/SKNETWORKS-FAMILY-AICAMP/SKN06-FINAL-6Team/blob/main/%EC%B5%9C%EC%A2%85%ED%8F%89%EA%B0%80%20%EC%82%B0%EC%B6%9C%EB%AC%BC/readme%20%EC%82%AC%EC%A7%84/object%20detection%20%ED%8F%89%EA%B0%80.png)
> Precision : 0.86
>
>  Recall : 0.69
>
>  F1-score : 0.74
>
</br>

## LLM
### Qustion
**input**
> **텍스트 및 음성**
>
> - 텍스트 입력 및 stt로 텍스트 변환
>
> **이미지**
>
> - YOLO + Clip 결합으로 이미지 인식 후 텍스트 변환
>
> **태그**
>
> - DB table의 태그로 특정 table에서 검색 가능
>

**회원상태에 따른 input-output 차이**
> **비회원**
>
> - 싱글턴 (1회의 질문-응답)
>
> **회원**
>
> - 멀티턴(이전 대화에 이어서 질문가능)
>
</br>

### STT/TTS
**1. STT(Whisper)**
   > **다양한 언어지원 및 높은 정확도**
   >
   > - STT API는 여러 언어와 방언을 지원
   >
   > - 최신 AI 모델 적용으로 다양한 억양과 노이즈에도 강함
   >
   > **실시간 변환 가능**
   >
   > - 웹소켓(WebSocket) 기반의 실시간 STT 지원 → 음성 입력이 즉시 텍스트로 변환됨
   >
**2. TTS(TTS-1)**
   > **다양하고 자연스러운 목소리 및 언어지원**
   >
   > - 사람의 감정, 강세, 억양을 표현하는 Neural TTS 적용
   > 
   > - 남/여성, 감정 표현 가능, 다국어 음성 제공
   >
   > **클라우드 기반으로 빠르게 처리**
   >
   > - API 호출을 통해 빠르게 음성 변환 가능
   > 
   > - TTS 모델을 직접 학습할 필요 없이 즉시 사용 가능
   > 
</br>

### Vector DB 및 Retriever
**시나리오**
![image](https://github.com/SKNETWORKS-FAMILY-AICAMP/SKN06-FINAL-6Team/blob/main/%EC%B5%9C%EC%A2%85%ED%8F%89%EA%B0%80%20%EC%82%B0%EC%B6%9C%EB%AC%BC/readme%20%EC%82%AC%EC%A7%84/%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4.png)
> 재료만 입력하는 경우외의 여러 가지의 질문의 종류 존재
>
> → 사용자가 입력한 재료 기반 추천만 제공하는 것보다, 상황을 고려한 요리 추천이 필요
>
> 하이브리드 서치 이용
>
**Mearge(Ensemble)-Faiss+BM25**
**Faiss(벡터 검색)**
  > 실시간 벡터 최적화를 위해 chroma 대신 faiss선택
  >
  > => vector index 검색 속도 증가
  >
**BM25(키워드 검색)**
  > 여러 키워드 검색 알고리즘 중에서도 정확한 검색 결과와 가중치 기반의 랭킹 조정이 가능
> 
</br>

**문제(BM25 사용의 한계)**
</br>
 - BM25는 로컬 저장 불가</br>
       → 실행할 때마다 새로 vectorstore 생성</br>
 - 데이터 규모가 커질수록 속도 문제 발생 </br>
       (20만 개 벡터 생성 시 최소 10분 소요)</br>
 - 대량의 레시피 데이터(20만 개) 처리 시 비효율적</br>
</br>
 **Qdrant** </br>
 **장점**</br>
 - 하이브리드 서치 지원</br>
 - 로컬 및 클라우드에 영구 저장 가능</br>   
     → 실행할 때마다 벡터 생성 필요 없음</br>
 - 빠른 인덱싱과 검색 속도 제공 </br>
     → 20만 개 벡터도 빠르게 검색 가능</br>
 - Scalable한 벡터 DB </br>
     → 대용량 데이터에서도 효율적 운영 가능</br>
### 결과
**비회원인 경우**
**회원인 경우**
## 활용 방안 및 기대효과
1. 사용자의 요리 고민 해결
   > AI가 사용자 맞춤형 레시피를 추천하여 "오늘 뭐 먹지?"에 대한 고민을 덜어줍니다.
   >
2. 음식 낭비 방지 (남은 재료 활용 추천)
   > 냉장고 속 남은 재료를 활용한 맞춤형 요리를 추천하여 식재료 낭비를 줄입니다.
   >
3. 요리 초보자도 쉽게 따라할 수 있는 요리 가이드
   > AI 챗봇이 단계별 대화형 요리 가이드를 제공하여 누구나 쉽게 요리할 수 있도록 돕습니다.
   >
4. 맞춤형 서비스 제공으로 사용자 만족도 증가
   > 개인 취향과 재료를 반영한 맞춤형 추천을 통해 사용자 경험을 향상시킵니다.
   >
## 발생 비용 및 비용 산출
### 발생 비용
1. Whisper(STT)
   > 1분당 0.006 → 한번당 4초 제한 0.0004 1번 이용당 0.0004 달러
   >
   > 하루 1000명 가정 :  매일 4달러
   >
2. TTS-1(TTS)
   > 1 character = $0.000015 (tts-1)
   >
   >한 세트 질문시 : (3개 레시피 추천을 받은 후 특정 레시피 하나를 추가적으로 질문한다고 가정) 평균 700~800자 → 0.0105 달러 ~ 0.012 달러
   >
   > 하루 1000명 가정 :  매일 10.5~12달러
   >

### 비용 산출
  현재 커뮤니티 및 사이트 활성화를 위해 리뷰 게시글 작성 시 쿠키를 지급하고 있지만 향후 **쿠키에 BM 도입**해서 비용 충당 예정
  
## 팀원 회고
김동훈
> 좋은 경험이었습니다.
>
조해원
> 2달이라는 시간동안 프로젝트하면서 정말 빠르게 지나간 것 같습니다.
>
> 백엔드와 프론트엔드 간의 연결이 중요하다는 것을 알게 되었고 이 분야는 서로 간 실시간으로 공유가 되어야 함을 뼈저리게 느꼈습니다.
>
> 초반에 계획했던 것 보다 구현이 잘 되지 않아서 아쉬운 마음도 있었지만 마지막까지 열심히 한 팀원들에게 박수를 보냅니다.
>
강채연
> 주어진 시간도 짧았지만 특히 마지막 3주간은 학교와 병행하며 프로젝트에 적극적으로 참여하지 못한 점이 아쉽고 팀장으로서 죄송합니다.
>
> 또 어려움이 많았지만 개인 시간을 할애하는 것까지 마다하지 않으며 열심히 참여해주신 모든 팀원 분들께 감사합니다.
>
> 이번 프로젝트를 통해 기획 단계에서부터 구현 가능한 항목에 대해 세부적으로 체크해야하는 것의 중요성을 깨달았고, LLM 사용 프로젝트에서 가장 중요한 점은 모델의 동작 방식을 명확히 이해하여 프롬프트 엔지니어링을 수행하는 과정인 것 같습니다.
>
> 프롬프트 엔지니어링 과정 중에 이전에 작업했던 항목들로 돌아가야할 수도 있음을 인지하고 충분한 시간을 확보하고 작업해야겠습니다.
>
전수연
> 부족한 부분을 극복하려고 노력하면서 앞으로 나아갈 수 있는 시간이었다.
> 
임연경
> 처음에는  2달동안 진행되는 프로젝트여서 시간이 길다고 생각했는데, 마무리가 되는 지금 시점에는 너무 시간이 부족하게 느껴집니다.
>
> 처음에는 잘해내고 완벽한 결과물을 내고 싶다는 욕심해 많은 기능들을 구상했지만 마무리 단계에서 제거를 하게 되어 너무 아쉬운 것같습니다.
>
> 다음 프로젝트를 진행하게 된다면 어떤식으로 계획을 구성하고 어떠한 순서로 진행해야하는지 알게 되어 더 잘할 수 있을 것같습니다.
>
