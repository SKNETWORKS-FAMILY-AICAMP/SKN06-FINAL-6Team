{% load static %}
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>비밀번호 찾기</title>
    <link rel="stylesheet" href="{% static 'css/find_pw.css' %}">
</head>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            // 인증번호 입력창을 표시할지 확인
            {% if request.session.show_verification %}
                document.getElementById("verification-section").classList.remove("hidden");
            {% endif %}

            // 비밀번호 재설정 폼을 표시할지 확인
            {% if request.session.is_verified %}
                document.getElementById("verification-section").classList.add("hidden");
                document.getElementById("reset-password-section").classList.remove("hidden");
            {% endif %}
        });
    </script>
</head>

<body>
    <div class="logo">
        <a href="{% url 'home' %}">
            <img src="{% static 'imgs/logo.png' %}" alt="로고">
        </a>
    </div>
    <div class="container">
        <h2>비밀번호 찾기</h2>
        <a href="{% url 'login' %}">
            <button class="close-btn">✖</button>
        </a>

    <!-- ✅ 1. 비밀번호 찾기 폼 -->
    <form id="find-pw-form" method="post" action="{% url 'find_pw' %}">
        {% csrf_token %}
        <div class="input-group">
            <input type="text" placeholder="이름" name="name" required value="{{ request.POST.name|default_if_none:'' }}">
        </div>
        <div class="input-group">
            <input type="text" placeholder="아이디" name="login_id" required value="{{ request.POST.login_id|default_if_none:'' }}">
        </div>
        <div class="verify-group">
            <input type="email" placeholder="이메일" name="email" required value="{{ request.POST.email|default_if_none:'' }}" class="email-input">
            <button class="verify-btn">인증번호 받기</button>
        </div>
    </form>

    <!-- ✅ 2. 인증번호 입력 필드 -->
    <div id="verification-section" class="hidden">
        <form method="post" action="{% url 'verify_otp' %}">
            {% csrf_token %}
            <div class="input-group">
                <input type="text" placeholder="인증번호 6자리(제한 시간 6분)" name="code" required>
            </div>
            <div class="button-container">
                <button class="next-btn">Next →</button>
            </div>
        </form>
    </div>
</body>
</html>
